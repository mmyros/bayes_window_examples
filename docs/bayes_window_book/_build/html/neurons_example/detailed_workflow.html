
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neurons example via low-level, flexible interface &#8212; My sample book</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks.html">
   Content with notebooks
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fneurons_example/detailed_workflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare">
   Prepare
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-data">
   Make some data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimate-model">
   Estimate model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-data-back">
   Add data back
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-elements-of-interactivity-wip">
   Appendix: Elements of interactivity (WIP)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neurons-example-via-low-level-flexible-interface">
<h1>Neurons example via low-level, flexible interface<a class="headerlink" href="#neurons-example-via-low-level-flexible-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare">
<h2>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">bayes_window.fitting</span> <span class="kn">import</span> <span class="n">fit_numpyro</span>
<span class="kn">from</span> <span class="nn">bayes_window.generative_models</span> <span class="kn">import</span> <span class="n">generate_fake_spikes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-data">
<h2>Make some data<a class="headerlink" href="#make-some-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">df_monster</span><span class="p">,</span> <span class="n">index_cols</span><span class="p">,</span> <span class="n">firing_rates</span> <span class="o">=</span> <span class="n">generate_fake_spikes</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                                <span class="n">n_neurons</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                                                <span class="n">n_mice</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                <span class="n">dur</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="p">)</span>


<span class="c1"># df[&#39;log_isi&#39;] = np.log10(df[&#39;isi&#39;])</span>

<span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">visualization</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>

<span class="n">reload</span><span class="p">(</span><span class="n">visualization</span><span class="p">)</span>
<span class="n">reload</span><span class="p">(</span><span class="n">utils</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;isi&#39;</span>
<span class="n">ddf</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_fold_change</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                 <span class="n">index_cols</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">),</span>
                                 <span class="n">treatment_name</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span>
                                 <span class="n">do_take_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span>  <span class="n">df</span><span class="o">=</span><span class="n">ddf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-e38f6e7f07fb49b5821b806325049640"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-e38f6e7f07fb49b5821b806325049640") {
      outputDiv = document.getElementById("altair-viz-e38f6e7f07fb49b5821b806325049640");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.8}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "size": {"value": 1.0}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right"}, "field": "isi diff", "scale": {"domain": [0.7197516408008197, 1.126044757882447], "zero": false}, "title": "isi diff"}}}, {"mark": {"type": "circle", "clip": true, "filled": true, "opacity": 0}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7197516408008197, 1.126044757882447], "zero": false}}}}, {"mark": {"type": "boxplot", "clip": true, "color": "black", "median": {"color": "red", "strokeWidth": 20}, "opacity": 0.3, "size": 9}, "encoding": {"x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7197516408008197, 1.126044757882447], "zero": false}}}}], "data": {"name": "data-dfb2d4c7ed0586ba0fe1fd6f70060b1a"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-dfb2d4c7ed0586ba0fe1fd6f70060b1a": [{"mouse": "m0bayes", "neuron": "0", "isi diff": 1.14936681123677}, {"mouse": "m0bayes", "neuron": "1", "isi diff": 1.2569039604598138}, {"mouse": "m0bayes", "neuron": "2", "isi diff": 0.8769063791028462}, {"mouse": "m0bayes", "neuron": "3", "isi diff": 1.106963077865274}, {"mouse": "m0bayes", "neuron": "4", "isi diff": 0.9272232425140811}, {"mouse": "m0bayes", "neuron": "5", "isi diff": 0.981529240041618}, {"mouse": "m0bayes", "neuron": "6", "isi diff": 1.0251189693837068}, {"mouse": "m0bayes", "neuron": "7", "isi diff": 0.8818791302940553}, {"mouse": "m1bayes", "neuron": "0", "isi diff": 0.7947824890644494}, {"mouse": "m1bayes", "neuron": "1", "isi diff": 0.7196543086407804}, {"mouse": "m1bayes", "neuron": "2", "isi diff": 0.9337187091124888}, {"mouse": "m1bayes", "neuron": "3", "isi diff": 0.7198312762044882}, {"mouse": "m1bayes", "neuron": "4", "isi diff": 1.0649704989729696}, {"mouse": "m1bayes", "neuron": "5", "isi diff": 1.0313409132102247}, {"mouse": "m1bayes", "neuron": "6", "isi diff": 0.8948291977747264}, {"mouse": "m1bayes", "neuron": "7", "isi diff": 1.0813944319763331}, {"mouse": "m2bayes", "neuron": "0", "isi diff": 0.658375610855035}, {"mouse": "m2bayes", "neuron": "1", "isi diff": 0.7287878620758869}, {"mouse": "m2bayes", "neuron": "2", "isi diff": 0.9812854462521666}, {"mouse": "m2bayes", "neuron": "3", "isi diff": 0.8461102739395732}, {"mouse": "m2bayes", "neuron": "4", "isi diff": 1.0342713789255917}, {"mouse": "m2bayes", "neuron": "5", "isi diff": 0.9414753479097007}, {"mouse": "m2bayes", "neuron": "6", "isi diff": 1.063332400769889}, {"mouse": "m2bayes", "neuron": "7", "isi diff": 0.8991655384548441}, {"mouse": "m3bayes", "neuron": "0", "isi diff": 1.0296530494079288}, {"mouse": "m3bayes", "neuron": "1", "isi diff": 0.8363531093989355}, {"mouse": "m3bayes", "neuron": "2", "isi diff": 0.8967426436704622}, {"mouse": "m3bayes", "neuron": "3", "isi diff": 0.9836640024828578}, {"mouse": "m3bayes", "neuron": "4", "isi diff": 0.9650180371422022}, {"mouse": "m3bayes", "neuron": "5", "isi diff": 0.7454935867324454}, {"mouse": "m3bayes", "neuron": "6", "isi diff": 1.031636592958373}, {"mouse": "m3bayes", "neuron": "7", "isi diff": 1.0244255278872143}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>TODO leave axis labels here somehow</p>
</div>
<div class="section" id="estimate-model">
<h2>Estimate model<a class="headerlink" href="#estimate-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y = list(set(df.columns) - set(index_cols))[0]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">fit_numpyro</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">treatment</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">condition</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">]),</span>
                    <span class="n">group</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">]),</span>
                    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">model_hierarchical</span><span class="p">,</span>
                    <span class="n">n_draws</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                                                                                        | 0/1100 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:   0%|                                                                                                            | 1/1100 [00:06&lt;2:04:13,  6.78s/it, 7 steps of size 3.98e-02. acc. prob=1.00]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:   4%|███▊                                                                                                      | 40/1100 [00:06&lt;02:09,  8.19it/s, 1023 steps of size 6.88e-03. acc. prob=0.97]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:   7%|███████▎                                                                                                  | 76/1100 [00:06&lt;00:56, 18.25it/s, 1023 steps of size 8.37e-03. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  10%|██████████▊                                                                                              | 113/1100 [00:07&lt;00:30, 32.04it/s, 1023 steps of size 1.49e-02. acc. prob=0.97]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  13%|██████████████▏                                                                                          | 148/1100 [00:07&lt;00:19, 48.85it/s, 1023 steps of size 1.74e-02. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  19%|████████████████████▌                                                                                     | 213/1100 [00:07&lt;00:09, 91.07it/s, 511 steps of size 1.22e-02. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  27%|████████████████████████████▊                                                                            | 302/1100 [00:07&lt;00:04, 164.00it/s, 511 steps of size 1.18e-02. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  36%|█████████████████████████████████████▍                                                                   | 392/1100 [00:07&lt;00:02, 248.54it/s, 511 steps of size 6.79e-03. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  43%|█████████████████████████████████████████████▏                                                           | 474/1100 [00:07&lt;00:01, 329.22it/s, 255 steps of size 1.20e-02. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  52%|██████████████████████████████████████████████████████▍                                                  | 570/1100 [00:07&lt;00:01, 435.05it/s, 511 steps of size 1.14e-02. acc. prob=0.98]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  61%|████████████████████████████████████████████████████████████████▌                                        | 676/1100 [00:07&lt;00:00, 555.82it/s, 255 steps of size 1.12e-02. acc. prob=0.99]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  71%|██████████████████████████████████████████████████████████████████████████▌                              | 781/1100 [00:07&lt;00:00, 662.35it/s, 255 steps of size 1.31e-02. acc. prob=0.99]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  81%|█████████████████████████████████████████████████████████████████████████████████████▎                   | 894/1100 [00:07&lt;00:00, 771.95it/s, 511 steps of size 1.00e-02. acc. prob=0.99]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warmup:  90%|██████████████████████████████████████████████████████████████████████████████████████████████▊          | 993/1100 [00:08&lt;00:00, 772.92it/s, 511 steps of size 7.19e-03. acc. prob=0.99]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sample:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 1086/1100 [00:08&lt;00:00, 749.89it/s, 511 steps of size 6.93e-03. acc. prob=1.00]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sample: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 1100/1100 [00:08&lt;00:00, 132.91it/s, 511 steps of size 6.93e-03. acc. prob=1.00]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-data-back">
<h2>Add data back<a class="headerlink" href="#add-data-back" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload(utils)</span>
<span class="c1"># df_both, trace = utils.add_data_to_posterior(df, posterior=trace.posterior, y=y,</span>
<span class="c1">#                                              fold_change_index_cols=[&#39;neuron&#39;, &#39;stim&#39;, &#39;mouse_code&#39;, ],</span>
<span class="c1">#                                              treatment_name=&#39;stim&#39;, b_name=&#39;slope_per_condition&#39;,</span>
<span class="c1">#                                              posterior_index_name=&#39;neuron&#39;, group_name=&#39;mouse&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + [markdown] hideCode=false hidePrompt=false</span>
<span class="c1"># # ## Plot data and posterior</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># # BayesWindow.regression_charts(df_both, y=f&#39;{y} diff&#39;, x=&#39;neuron&#39;,color=&#39;mouse_code&#39;,title=y,hold_for_facet=False,add_box=False)</span>
<span class="c1"># reload(visualization)</span>
<span class="c1">#</span>
<span class="c1"># chart_d, _ = visualization.plot_data(df=df_both, x=&#39;neuron&#39;, y=f&#39;{y} diff&#39;, color=&#39;mouse_code&#39;, highlight=False)</span>
<span class="c1"># chart_d</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># chart_p = visualization.plot_posterior(df=df_both, title=f&#39;d_{y}&#39;, x=&#39;neuron&#39;, )</span>
<span class="c1"># chart_p</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).resolve_scale(y=&#39;independent&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).facet(column=&#39;neuron&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix-elements-of-interactivity-wip">
<h2>Appendix: Elements of interactivity (WIP)<a class="headerlink" href="#appendix-elements-of-interactivity-wip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="c1">#axis=alt.Axis(labels=False, tickCount=0, title=&#39;&#39;)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">lines</span><span class="o">+</span><span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-30dbcdd26264413295d4626597e1fa2c"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-30dbcdd26264413295d4626597e1fa2c") {
      outputDiv = document.getElementById("altair-viz-30dbcdd26264413295d4626597e1fa2c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector001"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.043867731147030305, 0.09033388417770137], "zero": false}}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.043867731147030305, 0.09033388417770137], "zero": false}}}, "selection": {"selector001": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}], "data": {"name": "data-3707179dd2b817057021eb52410adb97"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3707179dd2b817057021eb52410adb97": [{"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 2.22117797913957, "Firing rate": 166.40944767250764, "firing_rate": 166.40944767250764, "i_spike": 43.0, "isi": 0.08105728238162307}, {"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 1.5956737947726691, "Firing rate": 39.41611304064339, "firing_rate": 39.41611304064339, "i_spike": 39.5, "isi": 0.08888845509444271}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 2.0566668823294383, "Firing rate": 113.93755150744349, "firing_rate": 113.93755150744349, "i_spike": 52.0, "isi": 0.06552529809697562}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 1.8935185947793616, "Firing rate": 78.25617105598548, "firing_rate": 78.25617105598548, "i_spike": 47.5, "isi": 0.06928597690755753}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 2.0155187649726396, "Firing rate": 103.63793832883431, "firing_rate": 103.63793832883431, "i_spike": 41.5, "isi": 0.08433952131112965}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 1.9989508536953489, "Firing rate": 99.75871669310536, "firing_rate": 99.75871669310536, "i_spike": 46.0, "isi": 0.0751008434033464}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 1.9382377940211255, "Firing rate": 86.7436702884892, "firing_rate": 86.7436702884892, "i_spike": 49.0, "isi": 0.07185886785190423}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 1.84860049955878, "Firing rate": 70.56681229614192, "firing_rate": 70.56681229614192, "i_spike": 64.5, "isi": 0.052986458901162124}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 1.806240822617492, "Firing rate": 64.00896761423449, "firing_rate": 64.00896761423449, "i_spike": 56.5, "isi": 0.059895123804534996}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 1.8867766321036554, "Firing rate": 77.05070771715172, "firing_rate": 77.05070771715172, "i_spike": 56.5, "isi": 0.0617592269763947}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 1.9404724862073532, "Firing rate": 87.19116614496376, "firing_rate": 87.19116614496376, "i_spike": 51.5, "isi": 0.06588348030887824}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 1.9286504829268827, "Firing rate": 84.84973356318554, "firing_rate": 84.84973356318554, "i_spike": 72.5, "isi": 0.04837750366197194}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 1.922352134205726, "Firing rate": 83.62808157606051, "firing_rate": 83.62808157606051, "i_spike": 68.5, "isi": 0.04995198718819986}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 2.2475843286898125, "Firing rate": 176.84155646944131, "firing_rate": 176.84155646944131, "i_spike": 67.5, "isi": 0.051914172660588676}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 2.0855837391833134, "Firing rate": 121.7821786458897, "firing_rate": 121.7821786458897, "i_spike": 67.0, "isi": 0.05160017132702375}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 1.9788867843885725, "Firing rate": 95.25478133179195, "firing_rate": 95.25478133179195, "i_spike": 60.0, "isi": 0.057756316496926516}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 2.906813959471979, "Firing rate": 806.8893056867381, "firing_rate": 806.8893056867381, "i_spike": 45.0, "isi": 0.07806353010488833}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 2.6519232524380745, "Firing rate": 448.6660956452093, "firing_rate": 448.6660956452093, "i_spike": 39.0, "isi": 0.08811334643037594}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 1.7461140569087301, "Firing rate": 55.733209946719924, "firing_rate": 55.733209946719924, "i_spike": 39.5, "isi": 0.08745311928458135}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 1.8920841080267334, "Firing rate": 77.9981151639821, "firing_rate": 77.9981151639821, "i_spike": 33.0, "isi": 0.10682146091552858}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.957685660974199, "Firing rate": 90.71636943538208, "firing_rate": 90.71636943538208, "i_spike": 51.0, "isi": 0.06590339146867694}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.958184072869242, "Firing rate": 90.8205385512347, "firing_rate": 90.8205385512347, "i_spike": 51.0, "isi": 0.06928645876753478}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 2.182818736988321, "Firing rate": 152.34167872791633, "firing_rate": 152.34167872791633, "i_spike": 53.0, "isi": 0.06596094195872604}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 1.5657584197920775, "Firing rate": 36.79242555365325, "firing_rate": 36.79242555365325, "i_spike": 35.5, "isi": 0.09784792895324672}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 1.9698067989163555, "Firing rate": 93.2839223815571, "firing_rate": 93.2839223815571, "i_spike": 64.0, "isi": 0.054250622879311046}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 2.026280951031504, "Firing rate": 106.23826047605202, "firing_rate": 106.23826047605202, "i_spike": 54.0, "isi": 0.06434806981333117}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 2.1086515209105965, "Firing rate": 128.42557560401877, "firing_rate": 128.42557560401877, "i_spike": 72.5, "isi": 0.048138890808298494}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 1.7381671094261588, "Firing rate": 54.72264862060455, "firing_rate": 54.72264862060455, "i_spike": 50.0, "isi": 0.06945025098757122}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 1.9922766229653694, "Firing rate": 98.2373464517919, "firing_rate": 98.2373464517919, "i_spike": 63.0, "isi": 0.05503743808209098}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 2.209865869488393, "Firing rate": 162.13092836525095, "firing_rate": 162.13092836525095, "i_spike": 57.5, "isi": 0.0610352418687408}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 2.1579070188549836, "Firing rate": 143.8490568772005, "firing_rate": 143.8490568772005, "i_spike": 80.0, "isi": 0.0434672873667238}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 2.139720967718953, "Firing rate": 137.94976586775613, "firing_rate": 137.94976586775613, "i_spike": 78.5, "isi": 0.04397210505430128}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 1.73866824702294, "Firing rate": 54.785830185295566, "firing_rate": 54.785830185295566, "i_spike": 39.0, "isi": 0.0898778450089389}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 1.8417398099150402, "Firing rate": 69.46080464097892, "firing_rate": 69.46080464097892, "i_spike": 34.5, "isi": 0.10251944703976396}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 1.6148020090988433, "Firing rate": 41.19096904074179, "firing_rate": 41.19096904074179, "i_spike": 43.0, "isi": 0.07870059609175907}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 1.6956279422804013, "Firing rate": 49.616707568944044, "firing_rate": 49.616707568944044, "i_spike": 33.0, "isi": 0.10461818748563885}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 1.6828054447879217, "Firing rate": 48.17319430368274, "firing_rate": 48.17319430368274, "i_spike": 57.5, "isi": 0.06009567229711088}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 1.6651588412596978, "Firing rate": 46.255016611493446, "firing_rate": 46.255016611493446, "i_spike": 45.5, "isi": 0.07674831444130067}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 2.149587197806585, "Firing rate": 141.11955483791667, "firing_rate": 141.11955483791667, "i_spike": 55.0, "isi": 0.06351031133521892}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 1.8716220154824759, "Firing rate": 74.40840847345477, "firing_rate": 74.40840847345477, "i_spike": 50.5, "isi": 0.06912211917680172}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 1.8149448057340087, "Firing rate": 65.30475518903351, "firing_rate": 65.30475518903351, "i_spike": 48.5, "isi": 0.07220513590245241}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 1.720663989044303, "Firing rate": 52.56104474806432, "firing_rate": 52.56104474806432, "i_spike": 58.0, "isi": 0.060347331110916246}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 2.0197089530126715, "Firing rate": 104.64270389954085, "firing_rate": 104.64270389954085, "i_spike": 61.5, "isi": 0.05663540283408517}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 1.8081354498348134, "Firing rate": 64.28881930892769, "firing_rate": 64.28881930892769, "i_spike": 52.5, "isi": 0.06360561698236436}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 2.3227325454841714, "Firing rate": 210.2483254476074, "firing_rate": 210.2483254476074, "i_spike": 56.5, "isi": 0.062061226540796446}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 2.5738770043027013, "Firing rate": 374.86682190557536, "firing_rate": 374.86682190557536, "i_spike": 63.0, "isi": 0.05474259784705258}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 1.9458096974694952, "Firing rate": 88.26930303734069, "firing_rate": 88.26930303734069, "i_spike": 70.5, "isi": 0.04921192875498321}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 2.172639336287909, "Firing rate": 148.81247380036146, "firing_rate": 148.81247380036146, "i_spike": 68.0, "isi": 0.05074896087722048}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 1.7440455900870682, "Firing rate": 55.46839378785905, "firing_rate": 55.46839378785905, "i_spike": 49.0, "isi": 0.07031193421128236}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 2.0121101246132236, "Firing rate": 102.82770066008841, "firing_rate": 102.82770066008841, "i_spike": 45.0, "isi": 0.07442209904221278}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 1.723575641350754, "Firing rate": 52.914615091139616, "firing_rate": 52.914615091139616, "i_spike": 41.5, "isi": 0.08378692459591947}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 2.2844771787804046, "Firing rate": 192.52058770861547, "firing_rate": 192.52058770861547, "i_spike": 44.5, "isi": 0.07910625095838424}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 1.8425335680663075, "Firing rate": 69.58787394063845, "firing_rate": 69.58787394063845, "i_spike": 50.5, "isi": 0.06705693859166076}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 1.9656305141712822, "Firing rate": 92.39118006642066, "firing_rate": 92.39118006642066, "i_spike": 52.0, "isi": 0.06597353166018488}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 2.247334148332534, "Firing rate": 176.73971418286095, "firing_rate": 176.73971418286095, "i_spike": 54.5, "isi": 0.06365631835545063}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 1.880837330597048, "Firing rate": 76.00415423501221, "firing_rate": 76.00415423501221, "i_spike": 54.5, "isi": 0.06316803649941528}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.7478147266993527, "Firing rate": 55.95188556106461, "firing_rate": 55.95188556106461, "i_spike": 51.0, "isi": 0.06874172914354161}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.9820749019563615, "Firing rate": 95.95661118166298, "firing_rate": 95.95661118166298, "i_spike": 63.0, "isi": 0.055548290427848555}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.7393430951130024, "Firing rate": 54.87102779816618, "firing_rate": 54.87102779816618, "i_spike": 51.0, "isi": 0.06830824990519122}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.7815543313704993, "Firing rate": 60.471999865922136, "firing_rate": 60.471999865922136, "i_spike": 46.5, "isi": 0.07350861063652031}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 1.8879518677667217, "Firing rate": 77.25949547621536, "firing_rate": 77.25949547621536, "i_spike": 81.0, "isi": 0.04313702541014566}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 2.100831793880035, "Firing rate": 126.1338912180742, "firing_rate": 126.1338912180742, "i_spike": 59.5, "isi": 0.05865902876913089}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 2.2651116106920073, "Firing rate": 184.12451279933126, "firing_rate": 184.12451279933126, "i_spike": 69.0, "isi": 0.05014621054855503}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 1.9638296905004482, "Firing rate": 92.00886862726105, "firing_rate": 92.00886862726105, "i_spike": 79.5, "isi": 0.04354914362787967}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 1.943005529788822, "Firing rate": 87.70119878989468, "firing_rate": 87.70119878989468, "i_spike": 38.5, "isi": 0.09077427589937082}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 1.584827720673426, "Firing rate": 38.443924942981226, "firing_rate": 38.443924942981226, "i_spike": 33.0, "isi": 0.10455571446677617}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 2.7105937019111437, "Firing rate": 513.562970162955, "firing_rate": 513.562970162955, "i_spike": 43.0, "isi": 0.07886538173772288}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 1.9881709204927, "Firing rate": 97.31301325244148, "firing_rate": 97.31301325244148, "i_spike": 39.0, "isi": 0.09057944373011194}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 2.047150343335556, "Firing rate": 111.46803449809282, "firing_rate": 111.46803449809282, "i_spike": 50.0, "isi": 0.06905539502146084}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 2.553257159734157, "Firing rate": 357.48445353896045, "firing_rate": 357.48445353896045, "i_spike": 48.5, "isi": 0.07075887788314754}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 1.7694645948122203, "Firing rate": 58.81181667622173, "firing_rate": 58.81181667622173, "i_spike": 41.0, "isi": 0.08334796838414847}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 2.142459317109146, "Firing rate": 138.82232608883567, "firing_rate": 138.82232608883567, "i_spike": 63.5, "isi": 0.05485119877552172}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 1.9176811650439267, "Firing rate": 82.7334557492382, "firing_rate": 82.7334557492382, "i_spike": 58.0, "isi": 0.05961684489591662}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 2.1610879480599965, "Firing rate": 144.90652709873459, "firing_rate": 144.90652709873459, "i_spike": 65.0, "isi": 0.053183896701122446}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 1.9342712292280342, "Firing rate": 85.95501673838696, "firing_rate": 85.95501673838696, "i_spike": 65.5, "isi": 0.05178885251538055}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 2.052152915527807, "Firing rate": 112.75944134241516, "firing_rate": 112.75944134241516, "i_spike": 58.0, "isi": 0.06036164424793552}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 2.007237730975911, "Firing rate": 101.68051354214883, "firing_rate": 101.68051354214883, "i_spike": 81.0, "isi": 0.041025690968802084}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 1.9232893558933566, "Firing rate": 83.80874858217028, "firing_rate": 83.80874858217028, "i_spike": 53.5, "isi": 0.06339924183046396}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 1.9631305980268003, "Firing rate": 91.86087926234745, "firing_rate": 91.86087926234745, "i_spike": 64.0, "isi": 0.05266947040807877}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 3.2164787898198006, "Firing rate": 1646.1855675513987, "firing_rate": 1646.1855675513987, "i_spike": 79.5, "isi": 0.04376973396611895}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 1.764530853410312, "Firing rate": 58.147474032004446, "firing_rate": 58.147474032004446, "i_spike": 50.5, "isi": 0.06806679111376548}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 1.6746412236405002, "Firing rate": 47.276054391916894, "firing_rate": 47.276054391916894, "i_spike": 54.5, "isi": 0.06400768044388754}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 2.3566317553505383, "Firing rate": 227.31691599721742, "firing_rate": 227.31691599721742, "i_spike": 47.5, "isi": 0.07179288695351314}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 2.370373100441439, "Firing rate": 234.6243597101549, "firing_rate": 234.6243597101549, "i_spike": 48.5, "isi": 0.0680176517468748}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.6963785399225564, "Firing rate": 49.70253501305419, "firing_rate": 49.70253501305419, "i_spike": 63.5, "isi": 0.054691276980215996}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.7185004437169789, "Firing rate": 52.299850052741164, "firing_rate": 52.299850052741164, "i_spike": 47.5, "isi": 0.0715380154674503}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 2.0249050179982, "Firing rate": 105.90220873317507, "firing_rate": 105.90220873317507, "i_spike": 67.5, "isi": 0.051579618823783126}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 2.0838871139009303, "Firing rate": 121.30734954712531, "firing_rate": 121.30734954712531, "i_spike": 53.0, "isi": 0.0663351297783985}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 2.144679994387365, "Firing rate": 139.53398397531063, "firing_rate": 139.53398397531063, "i_spike": 54.5, "isi": 0.06360834980303219}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 2.4231179187433436, "Firing rate": 264.92193515452226, "firing_rate": 264.92193515452226, "i_spike": 54.0, "isi": 0.06269575913139287}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 2.0248049837575315, "Firing rate": 105.87781830803385, "firing_rate": 105.87781830803385, "i_spike": 57.5, "isi": 0.058498362231476086}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 2.124798923708919, "Firing rate": 133.290416095511, "firing_rate": 133.290416095511, "i_spike": 56.0, "isi": 0.06277613065188278}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 2.5238731636328784, "Firing rate": 334.09745210500796, "firing_rate": 334.09745210500796, "i_spike": 60.0, "isi": 0.057433740240708915}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 2.328788943825046, "Firing rate": 213.20085589081742, "firing_rate": 213.20085589081742, "i_spike": 74.5, "isi": 0.04643148284325645}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 1.8565357720592304, "Firing rate": 71.8680352356996, "firing_rate": 71.8680352356996, "i_spike": 66.5, "isi": 0.0517563421253692}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 2.1200904945903076, "Firing rate": 131.85314543038092, "firing_rate": 131.85314543038092, "i_spike": 81.0, "isi": 0.04280012997412091}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 1.9866356164756491, "Firing rate": 96.96960275267874, "firing_rate": 96.96960275267874, "i_spike": 58.5, "isi": 0.05909295142179729}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 2.0957594702391003, "Firing rate": 124.66928543309913, "firing_rate": 124.66928543309913, "i_spike": 50.5, "isi": 0.06757673325762203}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 2.089219186957761, "Firing rate": 122.80588719436457, "firing_rate": 122.80588719436457, "i_spike": 58.0, "isi": 0.06018660325802836}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 1.8607482127272577, "Firing rate": 72.56851110754552, "firing_rate": 72.56851110754552, "i_spike": 47.0, "isi": 0.07341390110369567}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 2.436921931286532, "Firing rate": 273.47770789852785, "firing_rate": 273.47770789852785, "i_spike": 55.5, "isi": 0.06267667439431174}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 2.175382959826848, "Firing rate": 149.7555614970576, "firing_rate": 149.7555614970576, "i_spike": 48.5, "isi": 0.07160633819921604}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 1.9345862113073804, "Firing rate": 86.01738020725749, "firing_rate": 86.01738020725749, "i_spike": 57.0, "isi": 0.060778002146418604}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 2.214768552724074, "Firing rate": 163.97156914673616, "firing_rate": 163.97156914673616, "i_spike": 66.5, "isi": 0.05144365996737859}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 2.3472428301590025, "Firing rate": 222.45533733117594, "firing_rate": 222.45533733117594, "i_spike": 46.5, "isi": 0.07139061631772099}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 1.8611088039024988, "Firing rate": 72.62878917268766, "firing_rate": 72.62878917268766, "i_spike": 52.5, "isi": 0.06570460652018482}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 1.8824450165032183, "Firing rate": 76.28603037442281, "firing_rate": 76.28603037442281, "i_spike": 64.5, "isi": 0.053212562724479585}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 2.011260910578471, "Firing rate": 102.626829106501, "firing_rate": 102.626829106501, "i_spike": 58.5, "isi": 0.05999139324022945}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 1.8749272188380315, "Firing rate": 74.97685489770942, "firing_rate": 74.97685489770942, "i_spike": 57.0, "isi": 0.06075594708785976}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 1.7117948399359537, "Firing rate": 51.49853088204955, "firing_rate": 51.49853088204955, "i_spike": 55.0, "isi": 0.06344534391757627}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 2.1845392725917288, "Firing rate": 152.94640472810684, "firing_rate": 152.94640472810684, "i_spike": 79.0, "isi": 0.04381152981234593}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 2.1466218439790477, "Firing rate": 140.15927552232597, "firing_rate": 140.15927552232597, "i_spike": 75.5, "isi": 0.04606985733821976}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 1.81632034178984, "Firing rate": 65.51192211540071, "firing_rate": 65.51192211540071, "i_spike": 44.5, "isi": 0.07767611276648514}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 2.384895955784823, "Firing rate": 242.60288201340873, "firing_rate": 242.60288201340873, "i_spike": 48.5, "isi": 0.07134972592608471}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 1.6295323260789443, "Firing rate": 42.612040005542376, "firing_rate": 42.612040005542376, "i_spike": 46.5, "isi": 0.07406977171204353}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 2.144906629202257, "Firing rate": 139.60681822169798, "firing_rate": 139.60681822169798, "i_spike": 54.0, "isi": 0.06216644216266505}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 2.148340143009548, "Firing rate": 140.7149183471136, "firing_rate": 140.7149183471136, "i_spike": 56.0, "isi": 0.0609354453044654}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 1.7959258161140887, "Firing rate": 62.506591320359014, "firing_rate": 62.506591320359014, "i_spike": 60.0, "isi": 0.058358650277899445}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 1.9271283952004326, "Firing rate": 84.55287810811096, "firing_rate": 84.55287810811096, "i_spike": 65.5, "isi": 0.05298658609502407}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 1.7280089027500116, "Firing rate": 53.457531772555875, "firing_rate": 53.457531772555875, "i_spike": 48.0, "isi": 0.0717659664138196}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.896470581279458, "Firing rate": 78.78990580647232, "firing_rate": 78.78990580647232, "i_spike": 60.5, "isi": 0.05768789737270776}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.835694399450064, "Firing rate": 68.50060377523724, "firing_rate": 68.50060377523724, "i_spike": 55.5, "isi": 0.06225421335044107}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.9499793731373418, "Firing rate": 89.12086090807652, "firing_rate": 89.12086090807652, "i_spike": 66.0, "isi": 0.05156893145576819}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.9483526283747787, "Firing rate": 88.78766369478836, "firing_rate": 88.78766369478836, "i_spike": 64.5, "isi": 0.054154628568607345}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 1.9783829852734458, "Firing rate": 95.14434601069506, "firing_rate": 95.14434601069506, "i_spike": 69.0, "isi": 0.05094837194717978}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 1.7863074193952473, "Firing rate": 61.13746390068193, "firing_rate": 61.13746390068193, "i_spike": 64.5, "isi": 0.054068162562935056}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 2.5610881588676953, "Firing rate": 363.9889159376335, "firing_rate": 363.9889159376335, "i_spike": 69.0, "isi": 0.04983161347633302}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 2.1739108632668964, "Firing rate": 149.24880525606355, "firing_rate": 149.24880525606355, "i_spike": 75.5, "isi": 0.04615229918644063}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>

<span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-value</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>


<span class="c1"># Transparent selectors across the chart. This is what tells us</span>
<span class="c1"># the x-value of the cursor</span>
<span class="n">selectors</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="c1">#tooltip=color,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">text</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-6358ecd09c014537b499703b9dbe5412"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6358ecd09c014537b499703b9dbe5412") {
      outputDiv = document.getElementById("altair-viz-6358ecd09c014537b499703b9dbe5412");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.043867731147030305, 0.09033388417770137], "zero": false}}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}}, "selection": {"selector002": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["neuron"], "empty": "none"}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.043867731147030305, 0.09033388417770137], "zero": false}}}, "selection": {"selector003": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "text": {"condition": {"type": "quantitative", "field": "isi", "selection": "selector002"}, "value": " "}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.043867731147030305, 0.09033388417770137], "zero": false}}}}], "data": {"name": "data-3707179dd2b817057021eb52410adb97"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3707179dd2b817057021eb52410adb97": [{"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 2.22117797913957, "Firing rate": 166.40944767250764, "firing_rate": 166.40944767250764, "i_spike": 43.0, "isi": 0.08105728238162307}, {"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 1.5956737947726691, "Firing rate": 39.41611304064339, "firing_rate": 39.41611304064339, "i_spike": 39.5, "isi": 0.08888845509444271}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 2.0566668823294383, "Firing rate": 113.93755150744349, "firing_rate": 113.93755150744349, "i_spike": 52.0, "isi": 0.06552529809697562}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 1.8935185947793616, "Firing rate": 78.25617105598548, "firing_rate": 78.25617105598548, "i_spike": 47.5, "isi": 0.06928597690755753}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 2.0155187649726396, "Firing rate": 103.63793832883431, "firing_rate": 103.63793832883431, "i_spike": 41.5, "isi": 0.08433952131112965}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 1.9989508536953489, "Firing rate": 99.75871669310536, "firing_rate": 99.75871669310536, "i_spike": 46.0, "isi": 0.0751008434033464}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 1.9382377940211255, "Firing rate": 86.7436702884892, "firing_rate": 86.7436702884892, "i_spike": 49.0, "isi": 0.07185886785190423}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 1.84860049955878, "Firing rate": 70.56681229614192, "firing_rate": 70.56681229614192, "i_spike": 64.5, "isi": 0.052986458901162124}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 1.806240822617492, "Firing rate": 64.00896761423449, "firing_rate": 64.00896761423449, "i_spike": 56.5, "isi": 0.059895123804534996}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 1.8867766321036554, "Firing rate": 77.05070771715172, "firing_rate": 77.05070771715172, "i_spike": 56.5, "isi": 0.0617592269763947}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 1.9404724862073532, "Firing rate": 87.19116614496376, "firing_rate": 87.19116614496376, "i_spike": 51.5, "isi": 0.06588348030887824}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 1.9286504829268827, "Firing rate": 84.84973356318554, "firing_rate": 84.84973356318554, "i_spike": 72.5, "isi": 0.04837750366197194}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 1.922352134205726, "Firing rate": 83.62808157606051, "firing_rate": 83.62808157606051, "i_spike": 68.5, "isi": 0.04995198718819986}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 2.2475843286898125, "Firing rate": 176.84155646944131, "firing_rate": 176.84155646944131, "i_spike": 67.5, "isi": 0.051914172660588676}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 2.0855837391833134, "Firing rate": 121.7821786458897, "firing_rate": 121.7821786458897, "i_spike": 67.0, "isi": 0.05160017132702375}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 1.9788867843885725, "Firing rate": 95.25478133179195, "firing_rate": 95.25478133179195, "i_spike": 60.0, "isi": 0.057756316496926516}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 2.906813959471979, "Firing rate": 806.8893056867381, "firing_rate": 806.8893056867381, "i_spike": 45.0, "isi": 0.07806353010488833}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 2.6519232524380745, "Firing rate": 448.6660956452093, "firing_rate": 448.6660956452093, "i_spike": 39.0, "isi": 0.08811334643037594}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 1.7461140569087301, "Firing rate": 55.733209946719924, "firing_rate": 55.733209946719924, "i_spike": 39.5, "isi": 0.08745311928458135}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 1.8920841080267334, "Firing rate": 77.9981151639821, "firing_rate": 77.9981151639821, "i_spike": 33.0, "isi": 0.10682146091552858}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.957685660974199, "Firing rate": 90.71636943538208, "firing_rate": 90.71636943538208, "i_spike": 51.0, "isi": 0.06590339146867694}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.958184072869242, "Firing rate": 90.8205385512347, "firing_rate": 90.8205385512347, "i_spike": 51.0, "isi": 0.06928645876753478}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 2.182818736988321, "Firing rate": 152.34167872791633, "firing_rate": 152.34167872791633, "i_spike": 53.0, "isi": 0.06596094195872604}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 1.5657584197920775, "Firing rate": 36.79242555365325, "firing_rate": 36.79242555365325, "i_spike": 35.5, "isi": 0.09784792895324672}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 1.9698067989163555, "Firing rate": 93.2839223815571, "firing_rate": 93.2839223815571, "i_spike": 64.0, "isi": 0.054250622879311046}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 2.026280951031504, "Firing rate": 106.23826047605202, "firing_rate": 106.23826047605202, "i_spike": 54.0, "isi": 0.06434806981333117}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 2.1086515209105965, "Firing rate": 128.42557560401877, "firing_rate": 128.42557560401877, "i_spike": 72.5, "isi": 0.048138890808298494}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 1.7381671094261588, "Firing rate": 54.72264862060455, "firing_rate": 54.72264862060455, "i_spike": 50.0, "isi": 0.06945025098757122}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 1.9922766229653694, "Firing rate": 98.2373464517919, "firing_rate": 98.2373464517919, "i_spike": 63.0, "isi": 0.05503743808209098}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 2.209865869488393, "Firing rate": 162.13092836525095, "firing_rate": 162.13092836525095, "i_spike": 57.5, "isi": 0.0610352418687408}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 2.1579070188549836, "Firing rate": 143.8490568772005, "firing_rate": 143.8490568772005, "i_spike": 80.0, "isi": 0.0434672873667238}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 2.139720967718953, "Firing rate": 137.94976586775613, "firing_rate": 137.94976586775613, "i_spike": 78.5, "isi": 0.04397210505430128}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 1.73866824702294, "Firing rate": 54.785830185295566, "firing_rate": 54.785830185295566, "i_spike": 39.0, "isi": 0.0898778450089389}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 1.8417398099150402, "Firing rate": 69.46080464097892, "firing_rate": 69.46080464097892, "i_spike": 34.5, "isi": 0.10251944703976396}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 1.6148020090988433, "Firing rate": 41.19096904074179, "firing_rate": 41.19096904074179, "i_spike": 43.0, "isi": 0.07870059609175907}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 1.6956279422804013, "Firing rate": 49.616707568944044, "firing_rate": 49.616707568944044, "i_spike": 33.0, "isi": 0.10461818748563885}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 1.6828054447879217, "Firing rate": 48.17319430368274, "firing_rate": 48.17319430368274, "i_spike": 57.5, "isi": 0.06009567229711088}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 1.6651588412596978, "Firing rate": 46.255016611493446, "firing_rate": 46.255016611493446, "i_spike": 45.5, "isi": 0.07674831444130067}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 2.149587197806585, "Firing rate": 141.11955483791667, "firing_rate": 141.11955483791667, "i_spike": 55.0, "isi": 0.06351031133521892}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 1.8716220154824759, "Firing rate": 74.40840847345477, "firing_rate": 74.40840847345477, "i_spike": 50.5, "isi": 0.06912211917680172}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 1.8149448057340087, "Firing rate": 65.30475518903351, "firing_rate": 65.30475518903351, "i_spike": 48.5, "isi": 0.07220513590245241}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 1.720663989044303, "Firing rate": 52.56104474806432, "firing_rate": 52.56104474806432, "i_spike": 58.0, "isi": 0.060347331110916246}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 2.0197089530126715, "Firing rate": 104.64270389954085, "firing_rate": 104.64270389954085, "i_spike": 61.5, "isi": 0.05663540283408517}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 1.8081354498348134, "Firing rate": 64.28881930892769, "firing_rate": 64.28881930892769, "i_spike": 52.5, "isi": 0.06360561698236436}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 2.3227325454841714, "Firing rate": 210.2483254476074, "firing_rate": 210.2483254476074, "i_spike": 56.5, "isi": 0.062061226540796446}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 2.5738770043027013, "Firing rate": 374.86682190557536, "firing_rate": 374.86682190557536, "i_spike": 63.0, "isi": 0.05474259784705258}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 1.9458096974694952, "Firing rate": 88.26930303734069, "firing_rate": 88.26930303734069, "i_spike": 70.5, "isi": 0.04921192875498321}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 2.172639336287909, "Firing rate": 148.81247380036146, "firing_rate": 148.81247380036146, "i_spike": 68.0, "isi": 0.05074896087722048}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 1.7440455900870682, "Firing rate": 55.46839378785905, "firing_rate": 55.46839378785905, "i_spike": 49.0, "isi": 0.07031193421128236}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 2.0121101246132236, "Firing rate": 102.82770066008841, "firing_rate": 102.82770066008841, "i_spike": 45.0, "isi": 0.07442209904221278}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 1.723575641350754, "Firing rate": 52.914615091139616, "firing_rate": 52.914615091139616, "i_spike": 41.5, "isi": 0.08378692459591947}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 2.2844771787804046, "Firing rate": 192.52058770861547, "firing_rate": 192.52058770861547, "i_spike": 44.5, "isi": 0.07910625095838424}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 1.8425335680663075, "Firing rate": 69.58787394063845, "firing_rate": 69.58787394063845, "i_spike": 50.5, "isi": 0.06705693859166076}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 1.9656305141712822, "Firing rate": 92.39118006642066, "firing_rate": 92.39118006642066, "i_spike": 52.0, "isi": 0.06597353166018488}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 2.247334148332534, "Firing rate": 176.73971418286095, "firing_rate": 176.73971418286095, "i_spike": 54.5, "isi": 0.06365631835545063}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 1.880837330597048, "Firing rate": 76.00415423501221, "firing_rate": 76.00415423501221, "i_spike": 54.5, "isi": 0.06316803649941528}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.7478147266993527, "Firing rate": 55.95188556106461, "firing_rate": 55.95188556106461, "i_spike": 51.0, "isi": 0.06874172914354161}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.9820749019563615, "Firing rate": 95.95661118166298, "firing_rate": 95.95661118166298, "i_spike": 63.0, "isi": 0.055548290427848555}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.7393430951130024, "Firing rate": 54.87102779816618, "firing_rate": 54.87102779816618, "i_spike": 51.0, "isi": 0.06830824990519122}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.7815543313704993, "Firing rate": 60.471999865922136, "firing_rate": 60.471999865922136, "i_spike": 46.5, "isi": 0.07350861063652031}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 1.8879518677667217, "Firing rate": 77.25949547621536, "firing_rate": 77.25949547621536, "i_spike": 81.0, "isi": 0.04313702541014566}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 2.100831793880035, "Firing rate": 126.1338912180742, "firing_rate": 126.1338912180742, "i_spike": 59.5, "isi": 0.05865902876913089}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 2.2651116106920073, "Firing rate": 184.12451279933126, "firing_rate": 184.12451279933126, "i_spike": 69.0, "isi": 0.05014621054855503}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 1.9638296905004482, "Firing rate": 92.00886862726105, "firing_rate": 92.00886862726105, "i_spike": 79.5, "isi": 0.04354914362787967}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 1.943005529788822, "Firing rate": 87.70119878989468, "firing_rate": 87.70119878989468, "i_spike": 38.5, "isi": 0.09077427589937082}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "log_firing_rate": 1.584827720673426, "Firing rate": 38.443924942981226, "firing_rate": 38.443924942981226, "i_spike": 33.0, "isi": 0.10455571446677617}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 2.7105937019111437, "Firing rate": 513.562970162955, "firing_rate": 513.562970162955, "i_spike": 43.0, "isi": 0.07886538173772288}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "log_firing_rate": 1.9881709204927, "Firing rate": 97.31301325244148, "firing_rate": 97.31301325244148, "i_spike": 39.0, "isi": 0.09057944373011194}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 2.047150343335556, "Firing rate": 111.46803449809282, "firing_rate": 111.46803449809282, "i_spike": 50.0, "isi": 0.06905539502146084}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "log_firing_rate": 2.553257159734157, "Firing rate": 357.48445353896045, "firing_rate": 357.48445353896045, "i_spike": 48.5, "isi": 0.07075887788314754}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 1.7694645948122203, "Firing rate": 58.81181667622173, "firing_rate": 58.81181667622173, "i_spike": 41.0, "isi": 0.08334796838414847}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "log_firing_rate": 2.142459317109146, "Firing rate": 138.82232608883567, "firing_rate": 138.82232608883567, "i_spike": 63.5, "isi": 0.05485119877552172}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 1.9176811650439267, "Firing rate": 82.7334557492382, "firing_rate": 82.7334557492382, "i_spike": 58.0, "isi": 0.05961684489591662}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "log_firing_rate": 2.1610879480599965, "Firing rate": 144.90652709873459, "firing_rate": 144.90652709873459, "i_spike": 65.0, "isi": 0.053183896701122446}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 1.9342712292280342, "Firing rate": 85.95501673838696, "firing_rate": 85.95501673838696, "i_spike": 65.5, "isi": 0.05178885251538055}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "log_firing_rate": 2.052152915527807, "Firing rate": 112.75944134241516, "firing_rate": 112.75944134241516, "i_spike": 58.0, "isi": 0.06036164424793552}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 2.007237730975911, "Firing rate": 101.68051354214883, "firing_rate": 101.68051354214883, "i_spike": 81.0, "isi": 0.041025690968802084}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "log_firing_rate": 1.9232893558933566, "Firing rate": 83.80874858217028, "firing_rate": 83.80874858217028, "i_spike": 53.5, "isi": 0.06339924183046396}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 1.9631305980268003, "Firing rate": 91.86087926234745, "firing_rate": 91.86087926234745, "i_spike": 64.0, "isi": 0.05266947040807877}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "log_firing_rate": 3.2164787898198006, "Firing rate": 1646.1855675513987, "firing_rate": 1646.1855675513987, "i_spike": 79.5, "isi": 0.04376973396611895}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 1.764530853410312, "Firing rate": 58.147474032004446, "firing_rate": 58.147474032004446, "i_spike": 50.5, "isi": 0.06806679111376548}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "log_firing_rate": 1.6746412236405002, "Firing rate": 47.276054391916894, "firing_rate": 47.276054391916894, "i_spike": 54.5, "isi": 0.06400768044388754}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 2.3566317553505383, "Firing rate": 227.31691599721742, "firing_rate": 227.31691599721742, "i_spike": 47.5, "isi": 0.07179288695351314}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "log_firing_rate": 2.370373100441439, "Firing rate": 234.6243597101549, "firing_rate": 234.6243597101549, "i_spike": 48.5, "isi": 0.0680176517468748}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.6963785399225564, "Firing rate": 49.70253501305419, "firing_rate": 49.70253501305419, "i_spike": 63.5, "isi": 0.054691276980215996}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "log_firing_rate": 1.7185004437169789, "Firing rate": 52.299850052741164, "firing_rate": 52.299850052741164, "i_spike": 47.5, "isi": 0.0715380154674503}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 2.0249050179982, "Firing rate": 105.90220873317507, "firing_rate": 105.90220873317507, "i_spike": 67.5, "isi": 0.051579618823783126}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "log_firing_rate": 2.0838871139009303, "Firing rate": 121.30734954712531, "firing_rate": 121.30734954712531, "i_spike": 53.0, "isi": 0.0663351297783985}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 2.144679994387365, "Firing rate": 139.53398397531063, "firing_rate": 139.53398397531063, "i_spike": 54.5, "isi": 0.06360834980303219}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "log_firing_rate": 2.4231179187433436, "Firing rate": 264.92193515452226, "firing_rate": 264.92193515452226, "i_spike": 54.0, "isi": 0.06269575913139287}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 2.0248049837575315, "Firing rate": 105.87781830803385, "firing_rate": 105.87781830803385, "i_spike": 57.5, "isi": 0.058498362231476086}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "log_firing_rate": 2.124798923708919, "Firing rate": 133.290416095511, "firing_rate": 133.290416095511, "i_spike": 56.0, "isi": 0.06277613065188278}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 2.5238731636328784, "Firing rate": 334.09745210500796, "firing_rate": 334.09745210500796, "i_spike": 60.0, "isi": 0.057433740240708915}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "log_firing_rate": 2.328788943825046, "Firing rate": 213.20085589081742, "firing_rate": 213.20085589081742, "i_spike": 74.5, "isi": 0.04643148284325645}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 1.8565357720592304, "Firing rate": 71.8680352356996, "firing_rate": 71.8680352356996, "i_spike": 66.5, "isi": 0.0517563421253692}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "log_firing_rate": 2.1200904945903076, "Firing rate": 131.85314543038092, "firing_rate": 131.85314543038092, "i_spike": 81.0, "isi": 0.04280012997412091}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 1.9866356164756491, "Firing rate": 96.96960275267874, "firing_rate": 96.96960275267874, "i_spike": 58.5, "isi": 0.05909295142179729}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "log_firing_rate": 2.0957594702391003, "Firing rate": 124.66928543309913, "firing_rate": 124.66928543309913, "i_spike": 50.5, "isi": 0.06757673325762203}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 2.089219186957761, "Firing rate": 122.80588719436457, "firing_rate": 122.80588719436457, "i_spike": 58.0, "isi": 0.06018660325802836}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "log_firing_rate": 1.8607482127272577, "Firing rate": 72.56851110754552, "firing_rate": 72.56851110754552, "i_spike": 47.0, "isi": 0.07341390110369567}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 2.436921931286532, "Firing rate": 273.47770789852785, "firing_rate": 273.47770789852785, "i_spike": 55.5, "isi": 0.06267667439431174}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "log_firing_rate": 2.175382959826848, "Firing rate": 149.7555614970576, "firing_rate": 149.7555614970576, "i_spike": 48.5, "isi": 0.07160633819921604}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 1.9345862113073804, "Firing rate": 86.01738020725749, "firing_rate": 86.01738020725749, "i_spike": 57.0, "isi": 0.060778002146418604}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "log_firing_rate": 2.214768552724074, "Firing rate": 163.97156914673616, "firing_rate": 163.97156914673616, "i_spike": 66.5, "isi": 0.05144365996737859}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 2.3472428301590025, "Firing rate": 222.45533733117594, "firing_rate": 222.45533733117594, "i_spike": 46.5, "isi": 0.07139061631772099}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "log_firing_rate": 1.8611088039024988, "Firing rate": 72.62878917268766, "firing_rate": 72.62878917268766, "i_spike": 52.5, "isi": 0.06570460652018482}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 1.8824450165032183, "Firing rate": 76.28603037442281, "firing_rate": 76.28603037442281, "i_spike": 64.5, "isi": 0.053212562724479585}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "log_firing_rate": 2.011260910578471, "Firing rate": 102.626829106501, "firing_rate": 102.626829106501, "i_spike": 58.5, "isi": 0.05999139324022945}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 1.8749272188380315, "Firing rate": 74.97685489770942, "firing_rate": 74.97685489770942, "i_spike": 57.0, "isi": 0.06075594708785976}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "log_firing_rate": 1.7117948399359537, "Firing rate": 51.49853088204955, "firing_rate": 51.49853088204955, "i_spike": 55.0, "isi": 0.06344534391757627}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 2.1845392725917288, "Firing rate": 152.94640472810684, "firing_rate": 152.94640472810684, "i_spike": 79.0, "isi": 0.04381152981234593}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "log_firing_rate": 2.1466218439790477, "Firing rate": 140.15927552232597, "firing_rate": 140.15927552232597, "i_spike": 75.5, "isi": 0.04606985733821976}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 1.81632034178984, "Firing rate": 65.51192211540071, "firing_rate": 65.51192211540071, "i_spike": 44.5, "isi": 0.07767611276648514}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "log_firing_rate": 2.384895955784823, "Firing rate": 242.60288201340873, "firing_rate": 242.60288201340873, "i_spike": 48.5, "isi": 0.07134972592608471}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 1.6295323260789443, "Firing rate": 42.612040005542376, "firing_rate": 42.612040005542376, "i_spike": 46.5, "isi": 0.07406977171204353}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "log_firing_rate": 2.144906629202257, "Firing rate": 139.60681822169798, "firing_rate": 139.60681822169798, "i_spike": 54.0, "isi": 0.06216644216266505}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 2.148340143009548, "Firing rate": 140.7149183471136, "firing_rate": 140.7149183471136, "i_spike": 56.0, "isi": 0.0609354453044654}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "log_firing_rate": 1.7959258161140887, "Firing rate": 62.506591320359014, "firing_rate": 62.506591320359014, "i_spike": 60.0, "isi": 0.058358650277899445}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 1.9271283952004326, "Firing rate": 84.55287810811096, "firing_rate": 84.55287810811096, "i_spike": 65.5, "isi": 0.05298658609502407}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "log_firing_rate": 1.7280089027500116, "Firing rate": 53.457531772555875, "firing_rate": 53.457531772555875, "i_spike": 48.0, "isi": 0.0717659664138196}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.896470581279458, "Firing rate": 78.78990580647232, "firing_rate": 78.78990580647232, "i_spike": 60.5, "isi": 0.05768789737270776}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "log_firing_rate": 1.835694399450064, "Firing rate": 68.50060377523724, "firing_rate": 68.50060377523724, "i_spike": 55.5, "isi": 0.06225421335044107}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.9499793731373418, "Firing rate": 89.12086090807652, "firing_rate": 89.12086090807652, "i_spike": 66.0, "isi": 0.05156893145576819}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "log_firing_rate": 1.9483526283747787, "Firing rate": 88.78766369478836, "firing_rate": 88.78766369478836, "i_spike": 64.5, "isi": 0.054154628568607345}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 1.9783829852734458, "Firing rate": 95.14434601069506, "firing_rate": 95.14434601069506, "i_spike": 69.0, "isi": 0.05094837194717978}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "log_firing_rate": 1.7863074193952473, "Firing rate": 61.13746390068193, "firing_rate": 61.13746390068193, "i_spike": 64.5, "isi": 0.054068162562935056}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 2.5610881588676953, "Firing rate": 363.9889159376335, "firing_rate": 363.9889159376335, "i_spike": 69.0, "isi": 0.04983161347633302}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "log_firing_rate": 2.1739108632668964, "Firing rate": 149.24880525606355, "firing_rate": 149.24880525606355, "i_spike": 75.5, "isi": 0.04615229918644063}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "jb1"
        },
        kernelOptions: {
            kernelName: "jb1",
            path: "./neurons_example"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'jb1'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Jupyter Book Community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>